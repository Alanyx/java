# 避免过度同步

## 开放调用

在同步区域之外被调用的外来方法被称作“开放调用”（open call）。除了可以避免失败之外，开放调用还可以极大地增加并发性。

外来方法的运行时间可能为任意时长。如果在同步区域内调用外来方法，其他线程对受保护资源的访问就会遭到不必要的拒绝。


应该在同步区域内做尽可能少的工作。如果必须执行某个很耗时的动作，应该设法把这个动作移到同步区域的外部。

## 不要过度优化

在多核的时代，过度同步的成本并不是指获取锁所花费的 CPU 时间；而是指失去了并行的机会，因为需要确保每个核都有一个－致的内存视图而导致的延迟。

过度同步的另一项潜在开销在于，它会限制虚拟机优化代码执行的能力。

## 小结

总之，为了避免死锁和数据破坏，千万不要在同步区内部调用外来方法。更通俗地讲，要尽量将同步区字段内部的工作量限制到最少。

当你在设计一个可变类时，要考虑一下它们是否应该自己完成同步操作。在多核时代，这比永远不要过度同步来得更重要。

只有当你有足够的理由一定要在内部同步类的时候，才应该决定自己完成同步操作，同时还应该将这个决定清楚地写到文档中（详见第 82 条） 。